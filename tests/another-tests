import { folio } from '../lib/fixtures/base-fixture';
const { it, describe, expect, beforeEach, beforeAll } = folio;
import { waitForText, emailCreate, navigate, typeText, getText } from '../lib/helpers/helpers';
import { alty_cmd_stage } from '../lib/helpers/credentials';
import { groups, notifications } from '../lib/helpers/text-helpers';
import { CUSTOM_ALERT } from '../lib/selectors/base';
import { Login } from '../lib/page-objects/authentication';

const email = emailCreate();

describe('Checking all functions on the CMD dashboard', () => {
  //User registration for use in tests below
  beforeAll(async ({ browser }) => {
    const page = await browser.newPage();
    const auth = new Login(page);
    await navigate(alty_cmd_stage.URL, page);
    await auth.registration(email, alty_cmd_stage.PASSWORD);
    await auth.confirmation(email, 0);
    await page.close();
  });

  beforeEach(async ({ AltyObject }) => {
    await navigate(alty_cmd_stage.URL, AltyObject.auth.page);
    await AltyObject.auth.login(email, alty_cmd_stage.PASSWORD);
  });

  it('Check the ability to add WhatsApp group to the community ', async ({ AltyObject }) => {
    await AltyObject.dashboard.addGroupToCMD(groups.WHATS_APP.link);
    await AltyObject.dashboard.checkThatTheGroupWasAdded('ahaha-Test-alty', expect);
  });

  it('Check the ability to add Telegram group to the community ', async ({ AltyObject }) => {
    await AltyObject.dashboard.addGroupToCMD(groups.TELEGRAM.link);
    await AltyObject.dashboard.checkThatTheGroupWasAdded('Cherkasy_Job', expect);
  });
});
